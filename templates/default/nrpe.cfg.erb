# Autogenerated by Chef.

pid_file=<%= node['nagios']['nrpe']['pidfile'] %>
server_port=5666
nrpe_user=<%= node['nagios']['user'] %>
nrpe_group=<%= node['nagios']['group'] %>
dont_blame_nrpe=<%= node['nagios']['nrpe']['dont_blame_nrpe'] %>
debug=0
command_timeout=<%= node['nagios']['nrpe']['command_timeout'] %>
include_dir=<%= @nrpe_directory %>

command[check_zombie_procs]=<%= node['nagios']['plugin_dir'] %>/check_procs -w 5 -c 10 -s Z
command[check_total_procs]=<%= node['nagios']['plugin_dir'] %>/check_procs -w 500 -c 800
command[check_swap]=<%= node['nagios']['plugin_dir'] %>/check_swap -w '50%' -c '25%'
command[check_mem]=<%= node['nagios']['plugin_dir'] %>/check_mem.sh -w <%= node['nagios']['checks']['memory']['warning'] %> -c <%= node['nagios']['checks']['memory']['critical'] %> -p
command[check_chef_client]=<%= node['nagios']['plugin_dir'] %>/check_procs -w 1:2 -c 1:2 -C chef-client
command[check_smtp]=<%= node['nagios']['plugin_dir'] %>/check_smtp -H <%= node['nagios']['checks']['smtp_host'] %>
command[check_nginx]=<%= node['nagios']['plugin_dir'] %>/check_procs -w 2:3 -c 1:5 -C nginx
command[check_sphinx]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:1 -C searchd
<% unless node['mysql'].nil? -%>
command[check_mysql_server]=<%= node['nagios']['plugin_dir'] %>/check_mysql -H localhost -u debian-sys-maint -p <%= node['mysql']['server_debian_password'] %>
<% end -%>

#check mailq
command[check_mailq]=<%= node['nagios']['plugin_dir'] %>/check_mailq -w 20 -c 50

<% if node['stunnel']['version'] < 4.6 -%>
#check stunnel process
command[check_stunnel]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 6:6 -C stunnel4
<% else -%>
#check stunnel process
command[check_stunnel]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:1 -C stunnel4
<% end -%>

#check nullmailer processes
command[check_nullmailer]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:1 -C nullmailer-send

#check OSSEC processes
command[check_ossec]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:1 -C ossec-execd

#check rsyslog processes
#command[check_rsyslog]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:1 -C rsyslogd

#check chef status
command[check_chef_status]=<%= node['nagios']['plugin_dir'] %>/check_last_logs.pl /usr/bin/chef-client 270 /var/log/syslog

#chech NTP sync
command[check_ntp]=<%= node['nagios']['plugin_dir'] %>/check_ntp_time -H <%= @ntp_server %> -w 1.5 -c 3

#check Chef processes
command[check_chef]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "chef-client" -c 0:5

<% if node.roles.include?("hostname_eventstream") %>
#check eventstream process
command[check_eventstream]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "./eventstream.pl" -c 1:10 -u root
<% end %>

<% if node.roles.include?("eventstream_processor") %>
#check eventstream_processor process
command[check_eventstream_processor]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "/var/lib/sources/data_cloud/visitor_profile_processor.one-jar.jar eventstream_processor" -c 1:10

#check_splunk_forwarder
command[check_splunk_forwarder]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 5:6 --argument-array=splunk
<% end %>

<% if node.roles.include?("urest") %>
#check nodejs process
command[check_nodejs]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:1 -C node
<% end %>

<% if node.roles.include?("mongodb_cluster") %>
#check mongod processes
command[check_mongod]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:1 -C mongod
<% end %>

<% if node.recipes.include?("mongodb::mongos") %>
#check mongod processes
command[check_mongos]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:1 -C mongos
<% end %>

<% if node.roles.include?("utui") %>
#check UTUI log for errors 
<% end %>

<% if node.recipes.include?("openvpn") %>
#check openvpn processes
command[check_openvpn]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:1 -C openvpn
<% end %>

<% if node.recipes.include?("dnsmasq") %>
#check dnsmasq processes
command[check_dnsmasq]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:1 -C dnsmasq
<% end %>

<% if node.recipes.include?("rabbitmq") %>
#check rabbitmq processes
command[check_rabbitmq_epmd]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:1 -C epmd
command[check_rabbitmq_beam]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:2 -C beam
command[check_rabbitmq_server]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "/usr/sbin/rabbitmq-server"
command[check_rabbitmq_unackd]=sudo <%= node['nagios']['plugin_dir'] %>/check_rabbitmq_unackd.py 
<% end %>

<% if node.roles.include?("rabbitmq_server_cluster") %>
#check rabbitmq processes
command[check_rabbitmq_epmd]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:1 -C epmd
command[check_rabbitmq_beam]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:2 -C beam.smp
#NOTE: The paramaters set below <2:10> is set that way because of a bug in this version of check_procs that sees itself when checking processes, thus we need to find at least 2
command[check_rabbitmq_server]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "/usr/sbin/rabbitmq-server" -c 1:2 
command[check_rabbitmq_unackd]=sudo <%= node['nagios']['plugin_dir'] %>/check_rabbitmq_unackd.py
<% end %>

<% if node.recipes.include?("server2server") %>
#check s2s processes
command[check_s2s_tag_processor_perl]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:10 -a "./s2s_tag_processor.pl" -u root
command[check_s2s_http_perl]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:10 -a "./s2s_http.pl" -u root
command[check_s2s_tagger_perl]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:10 -a "./s2s_tagger.pl" -u root
<% end %>

<% if node.roles.include?("reporting") %>
#check reporting process
command[check_s2s_recorder_perl]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 1:10 -a "./s2s_recorder.pl" -u root

#check_splunk_forwarder
command[check_splunk_forwarder]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 5:6 --argument-array=splunk
<% end %>

<% if node.roles.include?("sitescan_analyzer") %>
#check sitescan analyzer processes
command[check_sitemap_audit_urls_perl]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "./audit-urls.pl" -c 1:20 -u root
command[check_sitemap_audit_analyzer_perl]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "./audit-analyzer.pl" -c 1:10 -u root
command[check_sitemap_audit_complete_perl]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "./audit-complete.pl" -c 1:10 -u root
<% end %>

<% if node.roles.include?("sitescan_complete") %>
#check sitescan complete processes
command[check_sitemap_audit_sitemap_perl]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "./audit-sitemap.pl" -c 1:10 -u root
command[check_sitemap_audit_complete_perl]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "./audit-complete.pl" -c 1:10 -u root
<% end %>

<% if node.roles.include?("sitescan_urls") %>
#check sitescan urls processes
command[check_sitemap_audit_urls_perl]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "./audit-urls.pl" -c 1:100 -u root
command[check_sitemap_audit_complete_perl]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "./audit-complete.pl" -c 1:10 -u root
<% end %>

<% if node.roles.include?("dc_visitor_processor") %>
#check DC VP processes
<% if @platform_version == "14.04" %>
command[check_visitor_processor]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "/var/lib/sources/data_cloud/visitor_profile_processor.one-jar.jar visitor_processor" -c 1:1
<% else %>
#NOTE: The paramaters set below <2:2> is set that way because of a bug in this version of check_procs that sees itself when checking processes, thus we need to find at least 2
command[check_visitor_processor]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "/var/lib/sources/data_cloud/visitor_profile_processor.one-jar.jar visitor_processor" -c 2:2
#check_splunk_forwarder
command[check_splunk_forwarder]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 5:6 --argument-array=splunk
command[vp_restart] = <%= node['nagios']['plugin_dir'] %>/vp_handler.sh
<% end %>
<% end %>

<% if node.roles.include?("publish_engine") %>
#check publish engine
#NOTE: The paramaters set below <2:10> is set that way because of a bug in this version of check_procs that sees itself when checking processes, thus we need to find at least 2
command[check_publish_engine]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "/var/lib/sources/publish_engine/publish_engine-jar-with-dependencies.jar" -c 1:2
<% end %>

<% if node.roles.include?("resource_uploader") %>
#check resource_uploader
#NOTE: The paramaters set below <2:10> is set that way because of a bug in this version of check_procs that sees itself when checking processes, thus we need to find at least 2
command[check_resource_uploader]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "/var/lib/sources/resource_uploader/resource_uploader-jar-with-dependencies.jar" -c 1:2
<% end %>

<% if node.roles.include?("dc_uconnect") %>
#check DC Uconnect process
command[check_uconnect]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "/usr/share/tealium/datacloud/uconnect.jar uconnect" -c 1:2

#check_splunk_forwarder
command[check_splunk_forwarder]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 5:6 --argument-array=splunk
<% end %>

<% if node.roles.include?("dc_bulk_downloader") %>
#check DC Bulk Downloader process
command[check_bulk_downloader]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "visitor_profile_processor.one-jar.jar bulk_downloader" -c 2:2

#check_splunk_forwarder
command[check_splunk_forwarder]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 5:6 --argument-array=splunk
<% end %>

<% if node.roles.include?("dc_amazon_uploader") %>
#check Amazon Uploader process
command[check_dc_amazon_uploader]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "amazon_uploader.jar amazon_uploader" -c 2:2

#check_splunk_forwarder
command[check_splunk_forwarder]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 5:6 --argument-array=splunk
<% end %>

<% if node.roles.include?("dc_query_aggregator") %>
#check DC QA processes
command[check_query_aggregator]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "visitor_profile_processor.one-jar.jar query_aggregator" -c 2:2

#check_splunk_forwarder
command[check_splunk_forwarder]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 5:6 --argument-array=splunk
<% end %>

<% if node.roles.include?("dc_message_router") %>
#check DC MR processes
command[check_message_router]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "visitor_profile_processor.one-jar.jar message_router" -c 2:2

#check_splunk_forwarder
command[check_splunk_forwarder]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 5:6 --argument-array=splunk
<% end %>

<% if node.roles.include?("dc_data_distributor") %>
#check DC DD process
command[check_data_distributor]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "visitor_profile_processor.one-jar.jar data_distributor" -c 2:2

#check_splunk_forwarder
command[check_splunk_forwarder]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 5:6 --argument-array=splunk
<% end %>

<% if node.roles.include?("dc_visitor_service") %>
#check DC VS process
command[check_visitor_service]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "visitor_profile_processor.one-jar.jar visitor_service" -c 2:3

#check_splunk_forwarder
command[check_splunk_forwarder]=<%= node['nagios']['plugin_dir'] %>/check_procs -c 5:6 --argument-array=splunk
<% end %>

<% if node.roles.include?("permission_cache") %>
#check permission cache process
command[check_permission_cache]=<%= node['nagios']['plugin_dir'] %>/check_procs -a "permission_cache.one-jar.jar com.tealium.permissioncache.app.Main" -c 2:2
<% end %>
