	# Service definitions
#
# Autogenerated by Chef.

define service {
    use                 default-service,srv-pnp
    host_name           *
    service_description ping
    check_command       check_ping!200.0,20%!500.0,60%
}

# monitoring service checks
define service {
    service_description Nagios
    hostgroup_name      <%= node['nagios']['server_role'] %>
    check_command       check-nagios
    contact_groups      admins
    use                 default-service,srv-pnp
}

# Uncomment if you're using Munin
#define service {
#    service_description Munin Client
#    hostgroup_name      all
#    check_command       check_tcp!4949
#    use                 default-service,srv-pnp
#}

# default checks for all hosts
# Uncomment if you're running chef-client as a daemon
#define service {
#    service_description Chef Client
#    hostgroup_name     base
#    check_command      check_chef_client
#    use                default-service,srv-pnp
#}

#define service {
#    service_description WebInject UTUI
#    hostgroup_name      nagios
#    check_command       check_webinject!UTUIconfig.xml
#    use                 default-service,srv-pnp
#}

#define service {
#    service_description WebInject RabbitMQ
#    hostgroup_name      rabbitmq
#    check_command       webinject!rabbitMQconfig.xml!rabbitMQ.xml
#    use                 default-service,srv-pnp
#}

define service {
    service_description Free Space All Disks
    #hostgroup_name      linux
    hostgroup_name      all
    check_command       check_all_disks
    use                 default-service,srv-pnp
}

#define service {
#    service_description Check mailq
#    hostgroup_name      linux
#    check_command       check_nrpe!check_mailq
#    use                 default-service,srv-pnp
#}

define service {
    service_description Check Jenkins 8080
    hostgroup_name      jenkins
    check_command       check_tcp!8080
    use                 default-service,srv-pnp
}

define service {
    service_description Check NodeJS 3030
    hostgroup_name      urest
    check_command       check_tcp!3030
    use                 default-service,srv-pnp
}

define service {
    service_description Check Uconnect Files to Process
    hostgroup_name      uconnect_logger,hostname_uconnect
    check_command       check_dir_files
    use                 uconnect-service,srv-pnp
}

<% unless @main_nagios.nil? -%>

#define service {
#    service_description Check Rabbit http_requests_queue VPC US WEST
#    <%= @designation %> <%= @main_nagios %>
#    check_command       check_rabbit_queues!10.1.3.201!/server2server!http_requests_queue!admin!admin!100,-1,100,-1!150,-1,150,-1
#    use                 default-service,srv-pnp
#}

#define service {
#    service_description Check Rabbit tag_request_queue VPC US WEST
#    <%= @designation %> <%= @main_nagios %>
#    check_command       check_rabbit_queues!10.1.3.201!/server2server!tag_request_queue!admin!admin!100,-1,100,-1!150,-1,150,-1
#    use                 default-service,srv-pnp
#}

#define service {
#    service_description Check Rabbit http_response_task VPC US WEST
#    <%= @designation %> <%= @main_nagios %>
#    check_command       check_rabbit_queues!10.1.3.201!/server2server!http_response_task!admin!admin!100,-1,100,-1!150,-1,150,-1
#    use                 default-service,srv-pnp
#}

#define service {
#    service_description Check Rabbit record_requests_que VPC US WEST
#    <%= @designation %> <%= @main_nagios %>
#    check_command       check_rabbit_queues!10.1.3.201!/server2server!record_requests_queue!admin!admin!1000,-1,100,-1!150,-1,150,-1
#    use                 default-service,srv-pnp
#}

define service {
    service_description Check Rabbit http_requests_queue NON_VPC US WEST
    <%= @designation %> <%= @main_nagios %>
    check_command       check_rabbit_queues!ec2-50-18-37-177.us-west-1.compute.amazonaws.com!/server2server!http_requests_queue!admin!toor4cars9window14five.!100,-1,100,-1!150,-1,150,-1
    use                 default-service,srv-pnp
}


define service {
    service_description Check Rabbit tag_request_queue NON_VPC US WEST
    <%= @designation %> <%= @main_nagios %>
    check_command       check_rabbit_queues!ec2-50-18-37-177.us-west-1.compute.amazonaws.com!/server2server!tag_request_queue!admin!toor4cars9window14five.!100,-1,100,-1!150,-1,150,-1
    use                 default-service,srv-pnp
}

define service {
    service_description Check Rabbit http_response_task NON_VPC US WEST
    <%= @designation %> <%= @main_nagios %>
    check_command       check_rabbit_queues!ec2-50-18-37-177.us-west-1.compute.amazonaws.com!/server2server!http_response_task!admin!toor4cars9window14five.!100,-1,100,-1!150,-1,150,-1
    use                 default-service,srv-pnp
}

#define service {
#    service_description Check Rabbit record_requests_que NON_VPC US WEST
#    <%= @designation %> <%= @main_nagios %>
#    check_command       check_rabbit_queues!ec2-50-18-37-177.us-west-1.compute.amazonaws.com!/server2server!record_requests_queue!admin!toor4cars9window14five.!1000,-1,100,-1!150,-1,150,-1
#    use                 default-service,srv-pnp
#}

define service {
    service_description Check Rabbit http_requests_queue NON_VPC US EAST
    <%= @designation %> <%= @main_nagios %>
    check_command       check_rabbit_queues!ec2-23-20-138-181.compute-1.amazonaws.com!/server2server!http_requests_queue!admin!toor4cars9window14five.!100,-1,100,-1!150,-1,150,-1
    use                 default-service,srv-pnp
}

define service {
    service_description Check Rabbit tag_request_queue NON_VPC US EAST
    <%= @designation %> <%= @main_nagios %>
    check_command       check_rabbit_queues!ec2-23-20-138-181.compute-1.amazonaws.com!/server2server!tag_request_queue!admin!toor4cars9window14five.!100,-1,100,-1!150,-1,150,-1
    use                 default-service,srv-pnp
}

define service {
    service_description Check Rabbit http_response_task NON_VPC US EAST
    <%= @designation %> <%= @main_nagios %>
    check_command       check_rabbit_queues!ec2-23-20-138-181.compute-1.amazonaws.com!/server2server!http_response_task!admin!toor4cars9window14five.!100,-1,100,-1!150,-1,150,-1
    use                 default-service,srv-pnp
}

define service {
    service_description Check Rabbit record_requests_que NON_VPC US EAST
    <%= @designation %> <%= @main_nagios %>
    check_command       check_rabbit_queues!ec2-23-20-138-181.compute-1.amazonaws.com!/server2server!record_requests_queue!admin!toor4cars9window14five.!1000,-1,100,-1!150,-1,150,-1
    use                 default-service,srv-pnp
}

define service {
    service_description Check Rabbit http_requests_queue NON_VPC EU WEST
    <%= @designation %> <%= @main_nagios %>
    check_command       check_rabbit_queues!ec2-46-137-17-176.eu-west-1.compute.amazonaws.com!/server2server!http_requests_queue!admin!toor4cars9window14five.!100,-1,100,-1!150,-1,150,-1
    use                 default-service,srv-pnp
}

define service {
    service_description Check Rabbit tag_request_queue NON_VPC EU WEST
    <%= @designation %> <%= @main_nagios %>
    check_command       check_rabbit_queues!ec2-46-137-17-176.eu-west-1.compute.amazonaws.com!/server2server!tag_request_queue!admin!toor4cars9window14five.!100,-1,100,-1!150,-1,150,-1
    use                 default-service,srv-pnp
}

define service {
    service_description Check Rabbit http_response_task NON_VPC EU WEST
    <%= @designation %> <%= @main_nagios %>
    check_command       check_rabbit_queues!ec2-46-137-17-176.eu-west-1.compute.amazonaws.com!/server2server!http_response_task!admin!toor4cars9window14five.!100,-1,100,-1!150,-1,150,-1
    use                 default-service,srv-pnp
}

define service {
    service_description Check Rabbit record_requests_que NON_VPC EU WEST
    <%= @designation %> <%= @main_nagios %>
    check_command       check_rabbit_queues!ec2-46-137-17-176.eu-west-1.compute.amazonaws.com!/server2server!record_requests_queue!admin!toor4cars9window14five.!100,-1,1000,-1!150,-1,150,-1
    use                 default-service,srv-pnp
}

define service {
    service_description Check MongoDB Backup - Cluster 1
    <%= @designation %>	<%= @main_nagios %>
    check_command       check_mongodb_backup!production_cluster_1
    use                 mongo-service,srv-pnp
    contact_groups      dbadmins
}

define service {
    service_description Check MongoDB Backup - Cluster 2
    <%= @designation %>	<%= @main_nagios %>
    check_command       check_mongodb_backup!production_cluster_2
    use                 mongo-service,srv-pnp
    contact_groups      dbadmins
}

define service {
    service_description Check MongoDB Snapshots - Cluster 1
    <%= @designation %>	<%= @main_nagios %>
    check_command       check_mongodb_snapshots!production_cluster_1
    use                 mongo-service,srv-pnp
    contact_groups      dbadmins
}

define service {
    service_description Check MongoDB Snapshots - Cluster 2
    <%= @designation %>	<%= @main_nagios %>
    check_command       check_mongodb_snapshots!production_cluster_2
    use                 mongo-service,srv-pnp
    contact_groups      dbadmins
}

define service {
    service_description Check CDN Max Age
    <%= @designation %>	<%= @main_nagios %>
    check_command       check_cdn_maxage
    use                 default-service,srv-pnp
}

define service {
    service_description Check SES SMTP Availability
    <%= @designation %> <%= @main_nagios %>
    check_command       check_smtp
    use                 default-service,srv-pnp
}

#define service {
#    service_description Check Uconnect TIQ Response Time
#    <%= @designation %> <%= @main_nagios %>
#    check_command       check_website_response!"http://datacloud.tealiumiq.com/tealium/main/10/i.gif"!500!1000
#    use                 default-service,srv-pnp
#}
<% end %>

#define service {
#    service_description Check Chef Status
#    hostgroup_name      all
#    check_command       check_nrpe!check_chef_status
#    use                 default-service,srv-pnp
#}


define service {
    service_description Check Tealium aptrepo
    hostgroup_name      apt_repo
    check_command       check_tcp!80
    use                 default-service,srv-pnp
}
 
define service {
    service_description Check Nexus
    hostgroup_name      production_nexus
    check_command       check_tcp!8081
    use                 default-service,srv-pnp
}

define service {
    service_description Check Tealium Website 80
    hostgroup_name      tealium_website
    check_command       check_http
    use                 default-service,srv-pnp
}

define service {
    service_description Nagios HTTP Auth
    hostgroup_name      nagios
    check_command       check_nagios_auth
    use                 default-service,srv-pnp
}

define service {
    service_description UTUI HTTP Auth
    hostgroup_name      utui
    check_command       check_utui_auth
    use                 default-service,srv-pnp
}

define service {
    service_description Check nodejs process
    hostgroup_name      urest
    check_command       check_nrpe!check_nodejs
    use                 default-service,srv-pnp
}

define service {
    service_description Check Eventstream process
    hostgroup_name      hostname_eventstream
    check_command       check_nrpe!check_eventstream
    use                 default-service,srv-pnp
}

define service {
    service_description Check rabbitmq unakd messages
    hostgroup_name      rabbitmq_server
    check_command       check_nrpe!check_rabbitmq_unackd
    use                 default-service,srv-pnp
}

## JMX Generic ##
define service {
    service_description Check JMX DataCloud Visitor Processor Java Heap
    hostgroup_name      dc_visitor_processor
    check_command       check_jmx_heap!<%= @vp_heap %>500000000
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud Message Router Java Heap
    hostgroup_name      dc_message_router
    check_command       check_jmx_heap!<%= @mr_heap %>500000000
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud Query Aggregator Java Heap
    hostgroup_name      dc_query_aggregator
    check_command       check_jmx_heap!<%= @qa_heap %>500000000
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud Data Distributor Java Heap
    hostgroup_name      dc_data_distributor
    check_command       check_jmx_heap!<%= @dd_heap %>500000000
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud Threading
    hostgroup_name      dc_visitor_processor
    check_command       check_jmx_threads!250!275
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud Threading
    hostgroup_name      dc_query_aggregator
    check_command       check_jmx_threads!40!60
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud Threading
    hostgroup_name      dc_message_router
    check_command       check_jmx_threads!40!60
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud Threading
    hostgroup_name      dc_data_distributor
    check_command       check_jmx_threads!40!60
    use                 jmx-service,srv-pnp
}

## JMX VP ##
define service {
    service_description Check JMX DataCloud VP ActiveVisitorEventCount
    hostgroup_name      dc_visitor_processor
    check_command       check_jmx_dc_vp_active_visitor
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud VP VisitorsToAggregator
    hostgroup_name      dc_visitor_processor
    check_command       check_jmx_dc_vp_visitors_to_aggregator
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud VP VisitorsStreamed
    hostgroup_name      dc_visitor_processor
    check_command       check_jmx_dc_vp_visitors_streamed
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud VP QueriesReceived
    hostgroup_name      dc_visitor_processor
    check_command       check_jmx_dc_vp_queries_received
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud VP VisitorCount
    hostgroup_name      dc_visitor_processor
    check_command       check_jmx_dc_vp_active_visitor_count
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud VP VisitorsPersisted
    hostgroup_name      dc_visitor_processor
    check_command       check_jmx_dc_vp_visitors_persisted
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud VP EventsReceived
    hostgroup_name      dc_visitor_processor
    check_command       check_jmx_dc_vp_total_events_received
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud VP ActiveQueryCount
    hostgroup_name      dc_visitor_processor
    check_command       check_jmx_dc_vp_active_query_count
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud VP RebalancedObjectsReceived
    hostgroup_name      dc_visitor_processor
    check_command       check_jmx_dc_vp_rebalanced_objects_received
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud VP RebalancedObjectsSent
    hostgroup_name      dc_visitor_processor
    check_command       check_jmx_dc_vp_rebalanced_objects_sent
    use                 jmx-service,srv-pnp
}

## JMX QA ##
define service {
    service_description Check JMX DataCloud QA TotalMessagesReceived
    hostgroup_name      dc_query_aggregator
    check_command       check_jmx_dc_qa_total_messages_received
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud QA TotalQueriesReceived
    hostgroup_name      dc_query_aggregator
    check_command       check_jmx_dc_qa_total_queries_received
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud QA TotalQueryResultsReceived
    hostgroup_name      dc_query_aggregator
    check_command       check_jmx_dc_qa_total_query_results_received
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud QA Query Aggregator ActiveQueryCount
    hostgroup_name      dc_query_aggregator
    check_command       check_jmx_dc_qa_active_query_count
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud QA TotalUnknownQueryResults
    hostgroup_name      dc_query_aggregator
    check_command       check_jmx_dc_qa_total_unknown_query_results
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud QA UnknownQueriesWithQueuedVisitors
    hostgroup_name      dc_query_aggregator
    check_command       check_jmx_dc_qa_unknown_queries_with_queued_visitors
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud QA UnknownQueriesQueuedVisitorCount
    hostgroup_name      dc_query_aggregator
    check_command       check_jmx_dc_qa_unknown_queries_queued_visitor_count
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud QA RebalancedObjectsReceived
    hostgroup_name      dc_query_aggregator
    check_command       check_jmx_dc_qa_rebalanced_objects_received
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud QA RebalancedObjectsSent
    hostgroup_name      dc_query_aggregator
    check_command       check_jmx_dc_qa_rebalanced_objects_sent
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud QA Query Manager ActiveQueryCount
    hostgroup_name      dc_query_aggregator
    check_command       check_jmx_dc_qa_qm_active_query_count
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud QA Query Monitor QueriesRecieved
    hostgroup_name      dc_query_aggregator
    check_command       check_jmx_dc_qa_qm_queries_recieved
    use                 jmx-service,srv-pnp
}

## JMX MR ##
define service {
    service_description Check JMX DataCloud MR TotalMessagesRouted
    hostgroup_name      dc_message_router
    check_command       check_jmx_dc_mr_total_messages_routed
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud MR TotalEventsRouted
    hostgroup_name      dc_message_router
    check_command       check_jmx_dc_mr_total_events_routed
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud MR TotalMessagesReceived
    hostgroup_name      dc_message_router
    check_command       check_jmx_dc_mr_total_messages_received
    use                 jmx-service,srv-pnp
}

define service {
    service_description Check JMX DataCloud MR TotalEventsReceived
    hostgroup_name      dc_message_router
    check_command       check_jmx_dc_mr_total_events_received
    use                 jmx-service,srv-pnp
}

## JMX DD ##
define service {
    service_description Check JMX DataCloud DD TotalMessagesReceived
    hostgroup_name      dc_data_distributor
    check_command       check_jmx_dc_dd_total_messages_received
    use                 jmx-service,srv-pnp
}
## END JMX ##


define service {
    service_description Check Permission Cache Process
    hostgroup_name      permission_cache
    check_command       check_nrpe!check_permission_cache
    use                 default-service,srv-pnp
}

define service {
    service_description Check DC Visitor Processor
    hostgroup_name      dc_visitor_processor
    check_command       check_nrpe!check_visitor_processor
    use                 default-service,srv-pnp
}

define service {
    service_description Check DC Query Aggregator
    hostgroup_name      dc_query_aggregator
    check_command       check_nrpe!check_query_aggregator
    use                 default-service,srv-pnp
}

define service {
    service_description Check DC Message Router
    hostgroup_name      dc_message_router
    check_command       check_nrpe!check_message_router
    use                 default-service,srv-pnp
}

define service {
    service_description rabbitmq HTTP Auth
    hostgroup_name      rabbitmq_server
    check_command       check_rabbitmq_auth
    use                 default-service,srv-pnp
}

define service {
    service_description Check rabbitmq epmd process
    hostgroup_name      rabbitmq_server
    check_command       check_nrpe!check_rabbitmq_epmd
    use                 default-service,srv-pnp
}

define service {
    service_description Check rsyslog process
    hostgroup_name      all
    check_command       check_nrpe!check_rsyslog
    use                 default-service,srv-pnp
}

define service {
    service_description Check rabbitmq beam process
    hostgroup_name      rabbitmq_server
    check_command       check_nrpe!check_rabbitmq_beam
    use                 default-service,srv-pnp
}

define service {
    service_description Check rabbitmq-server
    hostgroup_name      rabbitmq_server
    check_command       check_nrpe!check_rabbitmq_server
    use                 default-service,srv-pnp
}

define service {
    service_description Check S2S tag processor
    hostgroup_name      server2server
    check_command       check_nrpe!check_s2s_tag_processor_perl
    use                 default-service,srv-pnp
}

define service {
    service_description Check S2S http
    hostgroup_name      server2server
    check_command       check_nrpe!check_s2s_http_perl
    use                 default-service,srv-pnp
}

define service {
    service_description Check S2S tagger
    hostgroup_name      server2server
    check_command       check_nrpe!check_s2s_tagger_perl
    use                 default-service,srv-pnp
}

define service {
    service_description Check Site Audit sitemap
    hostgroup_name      sitemap_audit
    check_command       check_nrpe!check_sitemap_audit_sitemap_perl
    use                 default-service,srv-pnp
}

define service {
    service_description Check Site Audit URLS
    hostgroup_name      sitemap_audit
    check_command       check_nrpe!check_sitemap_audit_urls_perl
    use                 default-service,srv-pnp
}

define service {
    service_description Check Site Audit Complete
    hostgroup_name      sitemap_audit
    check_command       check_nrpe!check_sitemap_audit_complete_perl
    use                 default-service,srv-pnp
}

define service {
    service_description Check HTTPD Iron
    hostgroup_name      uconnect_logger,hostname_uconnect
    check_command       check_nrpe!check_iron
    use                 uconnect-service,srv-pnp
}

define service {
    service_description Check HTTPD Iron Processor
    hostgroup_name      uconnect_logger,hostname_uconnect
    check_command       check_nrpe!check_iron_processor
    use                 uconnect-service,srv-pnp
}

define service {
    service_description Check VPN Process
    hostgroup_name      openvpn_access_server, openvpn_client, openvpn_server
    check_command       check_nrpe!check_openvpn
    use                 default-service,srv-pnp
}

define service {
    service_description Check STunnel Processes
    #hostgroup_name      linux
    hostgroup_name      all
    check_command       check_nrpe!check_stunnel
    use                 default-service,srv-pnp
}

define service {
    service_description Check Nullmailer Process
    #hostgroup_name      linux
    hostgroup_name      all
    check_command       check_nrpe!check_nullmailer
    use                 default-service,srv-pnp
}

define service {
    service_description Check dnsmasq Process
    hostgroup_name      dnsmasq
    check_command       check_nrpe!check_dnsmasq
    use                 default-service,srv-pnp
}

#define service {
#    service_description Check mongod Process
#    hostgroup_name      mongodb_config, mongodb_replicaset_1
#    check_command       check_nrpe!check_mongod
#    use                 default-service,srv-pnp
#}

define service {
    service_description Load Average
    #hostgroup_name      linux
    hostgroup_name      all
    check_command       check_load
    use                 default-service,srv-pnp
}

define service {
    service_description Free Memory
    #hostgroup_name      linux
    hostgroup_name      all
    check_command       check_mem
    use                 default-service,srv-pnp
}

define service {
    service_description SSH
    #hostgroup_name      linux
    hostgroup_name      all
    check_command       check_ssh
    use                 default-service,srv-pnp
}

define service {
    service_description Processes
    #hostgroup_name      linux
    hostgroup_name      all
    check_command       check_local_procs
    use                 default-service,srv-pnp
}

define service {
  service_description   Check UTUI Logs - CDN Login Error
  hostgroup_name        utui
  check_command         check_nrpe!check_logfiles_utui_login_error
  use                   log-service,srv-pnp
}

define service {
  service_description   Check UTUI Logs - CDN Publish Error
  hostgroup_name        utui
  check_command         check_nrpe!check_logfiles_utui_publish_error
  use                   log-service,srv-pnp
}

define service {
  service_description   Check UTUI Logs - CDN smartFTP Error
  hostgroup_name        utui
  check_command         check_nrpe!check_logfiles_utui_smartFTP_error
  use                   log-service,srv-pnp
}

define service {
  service_description   Check UTUI Logs - CDN FTP Upload Error
  hostgroup_name        utui
  check_command         check_nrpe!check_logfiles_utui_ftp_upload_error
  use                   log-service,srv-pnp
}

define service {
  service_description   Check UTUI Logs - Publish Insert
  hostgroup_name        utui
  check_command         check_nrpe!check_logfiles_utui_publish_insert
  use                   log-service,srv-pnp
}

define service {
  service_description   Check Uconnect Rabbit Connection
  hostgroup_name        uconnect_logger
  check_command         check_nrpe!check_logfiles_rabbit_connection
  use                   uconnect-service,srv-pnp
}

define service {
  service_description   Check EventStream Logging
  hostgroup_name        hostname_eventstream
  check_command         check_nrpe!check_eventstream_logging
  use                   log-service,srv-pnp
}

define service {
  service_description   Check Uconnect Iron Create
  hostgroup_name        hostname_uconnect
  check_command         check_nrpe!check_logfiles_iron_create
  use                   log-service,srv-pnp
}

define service {
  service_description   Check Uconnect Iron Move
  hostgroup_name        hostname_uconnect
  check_command         check_nrpe!check_logfiles_iron_move
  use                   log-service,srv-pnp
}

define service {
  service_description   Check Uconnect Iron Write
  hostgroup_name        hostname_uconnect
  check_command         check_nrpe!check_logfiles_iron_write
  use                   log-service,srv-pnp
}

define service {
  service_description   Check Uconnect Iron Processor Process
  hostgroup_name        hostname_uconnect
  check_command         check_nrpe!check_logfiles_iron_processor_process
  use                   log-service,srv-pnp
}

define service {
  service_description   Check Uconnect Iron Processor Quarantine
  hostgroup_name        hostname_uconnect
  check_command         check_nrpe!check_logfiles_iron_processor_quarantine
  use                   log-service,srv-pnp
}

#<% if node.recipes.include?("uconnect::s2s_logger_plenv") %>
#<% nodesize = node[:ec2][:instance_type].split('.').last %>
#<% num_procs = node[:uconnect][:iron_processes][nodesize] %>
#<% for i in 1..num_procs %>
#define service {
#  service_description   Check Uconnect Rabbit Connection<%= i %>
#  hostgroup_name        hostname_uconnect
#  check_command         check_nrpe!check_logfiles_rabbit_connection<%= i %>
#  use                   log-service,srv-pnp
#}
#<% end %>
#<% end %>


define service {
  service_description   Check Uconnect Rabbit Connection1
  hostgroup_name        hostname_uconnect
  check_command         check_nrpe!check_logfiles_rabbit_connection1
  use                   log-service,srv-pnp
}

define service {
  service_description   Check Uconnect Rabbit Connection2
  hostgroup_name        hostname_uconnect
  check_command         check_nrpe!check_logfiles_rabbit_connection2
  use                   log-service,srv-pnp
}

#define service {
#  service_description   Check Uconnect Rabbit Connection3
#  hostgroup_name        hostname_uconnect
#  check_command         check_nrpe!check_logfiles_rabbit_connection3
#  use                   log-service,srv-pnp
#}

#define service {
#  service_description   Check Uconnect Rabbit Connection4
#  hostgroup_name        hostname_uconnect
#  check_command         check_nrpe!check_logfiles_rabbit_connection4
#  use                   log-service,srv-pnp
#}

define service {
  service_description   Check Uconnect Rabbit Authentication
  hostgroup_name        uconnect_logger
  check_command         check_nrpe!check_logfiles_rabbit_auth
  use                   log-service,srv-pnp
}

define service {
  service_description   Check Uconnect Rabbit Authentication1
  hostgroup_name        hostname_uconnect
  check_command         check_nrpe!check_logfiles_rabbit_auth1
  use                   log-service,srv-pnp
}

define service {
  service_description   Check Uconnect Rabbit Authentication2
  hostgroup_name        hostname_uconnect
  check_command         check_nrpe!check_logfiles_rabbit_auth2
  use                   log-service,srv-pnp
}

#define service {
#  service_description   Check Uconnect Rabbit Authentication3
#  hostgroup_name        hostname_uconnect
#  check_command         check_nrpe!check_logfiles_rabbit_auth3
#  use                   log-service,srv-pnp
#}

#define service {
#  service_description   Check Uconnect Rabbit Authentication4
#  hostgroup_name        hostname_uconnect
#  check_command         check_nrpe!check_logfiles_rabbit_auth4
#  use                   log-service,srv-pnp
#}

define service {
  service_description   Check ntp sync
  hostgroup_name        all
  check_command         check_nrpe!check_ntp
  use                   default-service,srv-pnp
}

define service {
  service_description   Check DigitalVelocity Website 8080
  hostgroup_name        tealium_website
  check_command         check_HTTP_8080
  use                   default-service,srv-pnp
}

define service {
  service_description   Check mongos 27017
  hostgroup_name        mongos
  check_command         check_tcp!27017
  use                   default-service,srv-pnp
}

define service {
  service_description   Check mongodb_config 27017
  hostgroup_name        mongodb_config
  check_command         check_tcp!27017
  use                   default-service,srv-pnp
}

define service {
  service_description   Check mongodb_replicaset_1 27017
  hostgroup_name        mongodb_replicaset_1
  check_command         check_tcp!27017
  use                   default-service,srv-pnp
}

define service {
  service_description   Check Nagios_auth
  hostgroup_name        nagios
  check_command         check_nagios_auth
  use                   default-service,srv-pnp
}

define service {
  service_description   Check uconnect_service 9090
  hostgroup_name        uconnect_logger,hostname_uconnect
  check_command         check_uconnect_service
  use                   uconnect-service,srv-pnp
}

define service {
  service_description   Check utui_service 8443
  hostgroup_name        utui
  check_command         check_utui_service
  use                   default-service,srv-pnp
}

define service {
  service_description   Check urest_service
  hostgroup_name        urest
  check_command         check_urest_service
  use                   default-service,srv-pnp
}

<% unless @service_hosts['monitoring'].nil? -%>
# If the monitoring host is a postfix relay, uncomment this.
#define service {
#    service_description Postfix
#    hostgroup_name      monitoring
#    check_command       check_nrpe!check_smtp
#    use                 default-service,srv-pnp
#}

# If the monitoring host is a syslog server, uncomment this.
#define service {
#    service_description Rsyslog
#    hostgroup_name      monitoring
#    check_command       check_tcp!514
#    use                 default-service,srv-pnp
#}

<% end -%>
<% unless @service_hosts['webserver'].nil? -%>
# basic web server http check
define service {
    service_description HTTP Processes
    hostgroup_name      webserver
    check_command       check_http
    use                 default-service,srv-pnp
}

<% end -%>
<% unless @service_hosts['appserver'].nil? -%>
# basic check if appserver role is running unicorn
define service {
    service_description Unicorn Processes
    hostgroup_name      appserver
    check_command       check_nrpe!check_unicorn
    use                 default-service,srv-pnp
}

define service {
    service_description Unicorn HTTP
    hostgroup_name      appserver
    check_command       check_http_port_expect!8080!"HTTP/1.1 302 Found"
    use                 default-service,srv-pnp
}

<% end -%>
<% unless @service_hosts['database_master'].nil? -%>
# basic check if the database_master role is a mysql server
# database_master service checks
define service {
    service_description MySQL
    hostgroup_name      database_master
    check_command       check_nrpe!check_mysql_server
    use                 default-service,srv-pnp
}

<% end -%>

# Services defined by data bags
<% @services.each do |service| -%>
  <% unless @service_hosts[service['hostgroup_name'].nil? && service['hostgroup_name'] != 'all' ] -%>
define service {
  service_description <%= service['id'] %>
  hostgroup_name <%= service['hostgroup_name'] %>
  check_command check_<%= service['id'] %>
  use default-service,srv-pnp
}
  <% end -%>
<% end -%>
